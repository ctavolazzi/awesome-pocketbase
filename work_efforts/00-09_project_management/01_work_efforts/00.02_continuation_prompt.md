# Continuation Prompt for Ollama 90s Social Feed

## Status: Active
**Created:** 2025-10-18 09:56
**Last Updated:** 2025-10-18 09:56

## For Next AI Session

### Context
You are continuing work on an Ollama-powered 90s-styled social media feed built with PocketBase. The project successfully combines:
- Modern real-time backend (PocketBase)
- AI content generation (Ollama)
- Nostalgic 90s aesthetic (retro UI)

### Current State
✅ **Completed:**
- Full 90s retro styling (Comic Sans, beveled borders, neon colors)
- Ollama integration for AI-generated posts
- Real-time post updates via WebSocket
- User authentication and authorization
- Post creation and deletion
- Category tagging
- Activity log with timestamps
- Stats tracking (total posts, AI posts)
- Starfield background animation
- Construction banner and browser badges
- Special AI post indicators (glowing "🤖 AI BOT 🤖" badges)
- Johnny Decimal work_efforts folder structure

📋 **Priority Tasks (Core Functionality):**
1. **Improve Ollama Integration**:
   - Create multiple AI user personas (different personalities/writing styles)
   - Generate posts from different AI users
   - Vary posting frequency and topics
   - Add error handling and reconnection logic

2. **Implement Standard Social Feed Features**:
   - Lazy loading / infinite scroll
   - Load most recent posts first on page load
   - Fetch older posts as user scrolls down
   - "Load More" button fallback
   - Show loading indicators during fetch
   - Optimize for large post counts (100s or 1000s of posts)

3. **Enhance Real-Time Experience**:
   - Live updates when new posts arrive
   - Smooth insertion of new posts at top of feed
   - Notification badge for new posts while scrolling
   - Auto-scroll to top on refresh
   - Handle concurrent users gracefully

4. **Persistent Data Management**:
   - Ensure posts persist across server restarts
   - Implement proper pagination
   - Cache strategy for recent posts
   - Handle database growth

📋 **Enhancement Tasks (Nice-to-Have):**
1. Add hit counter with digit flip animation
2. Implement chaos mode features (sparkles, confetti, screen shake)
3. Add webmaster badge with rotating borders
4. Implement Konami Code easter egg
5. Create guestbook modal
6. Add awards section
7. Connect actual MIDI audio file

### Project Location
```
/Users/ctavolazzi/Code/awesome-pocketbase/
├── work_efforts/                    # This documentation
├── pocketbase-demo/                 # Main application
│   ├── public/
│   │   ├── index.html              # Retro UI
│   │   ├── style.css               # 90s styling
│   │   └── app.js                  # Client logic
│   ├── setup.mjs                   # DB setup
│   ├── ollama-feed.mjs             # AI posts
│   └── pocketbase                  # Binary
```

### How to Run

#### Prerequisites Check
```bash
# 1. Ensure PocketBase is installed
ls pocketbase-demo/pocketbase

# 2. Ensure Ollama is installed
ollama --version

# 3. Pull required model
ollama pull llama3.2:1b
```

#### Start Everything
```bash
# Terminal 1: PocketBase server
cd /Users/ctavolazzi/Code/awesome-pocketbase/pocketbase-demo
./pocketbase serve

# Terminal 2: Web server
cd /Users/ctavolazzi/Code/awesome-pocketbase/pocketbase-demo
npx live-server --port=4173 --entry-file=public/index.html

# Terminal 3: Ollama feed (optional)
cd /Users/ctavolazzi/Code/awesome-pocketbase/pocketbase-demo
npm run ollama
```

#### Verify Setup
1. Open browser to `http://localhost:4173`
2. Check that starfield is animating
3. Check connection status shows "Online"
4. Try signing in with `demo@pocketbase.dev` / `PocketBaseDemo42`
5. Create a test post
6. Watch for Ollama AI posts (if running)

### Key Files to Modify

#### For UI Changes
- `/pocketbase-demo/public/index.html` - Structure
- `/pocketbase-demo/public/style.css` - Styling
- `/pocketbase-demo/public/app.js` - Interactivity

#### For Backend Changes
- `/pocketbase-demo/setup.mjs` - Database schema
- `/pocketbase-demo/ollama-feed.mjs` - AI behavior

### Current Issues to Address
1. **Hit Counter**: Needs implementation with PocketBase backend
   - Create digit flip animation
   - Store count in `site_stats` collection
   - Display on page load
   - Increment on each visit

2. **Chaos Mode**: Needs full implementation
   - Add button in UI
   - Implement mouse sparkle trail
   - Create random pop-up system
   - Add confetti generator

3. **Mobile Responsive**: Needs improvement
   - Browser badges hide on mobile
   - Layout switches to single column
   - Consider touch-friendly interactions

### Design Guidelines
- Keep 90s aesthetic authentic but functional
- Use Comic Sans MS and Courier New fonts
- Stick to neon color palette (cyan, magenta, yellow)
- Add blinking/wiggling animations liberally
- Include retro elements (beveled borders, outset buttons)
- Make AI posts visually distinct
- Maintain accessibility (ARIA labels, semantic HTML)

### Code Style
- Use ES6+ JavaScript
- Keep functions focused and small
- Comment complex logic
- Use meaningful variable names
- Follow existing patterns in `app.js`

### Testing Checklist
Before committing new features, verify:
- [ ] Page loads without errors
- [ ] Animations run smoothly
- [ ] Real-time updates work
- [ ] Forms submit correctly
- [ ] AI posts display with special styling
- [ ] No linter errors
- [ ] Mobile view is functional
- [ ] Accessibility features work

### Git Workflow
```bash
# 1. Check current status
git status

# 2. Stage changes
git add -A

# 3. Commit with descriptive message
git commit -m "feat: [brief description]

- Bullet point 1
- Bullet point 2"

# 4. Update work efforts
# Edit: work_efforts/00-09_project_management/01_work_efforts/00.01_ollama_90s_social_feed.md
# Edit: work_efforts/00-09_project_management/02_devlogs/00.01_2025-10-18_retro_transformation.md
```

### Work Efforts System
This project uses the Johnny Decimal system for organization:
- `00-09`: Project Management
- `10-19`: Development
- `20-29`: Documentation

**Main documents:**
- Work effort: `work_efforts/00-09_project_management/01_work_efforts/00.01_ollama_90s_social_feed.md`
- Latest devlog: `work_efforts/00-09_project_management/02_devlogs/00.01_2025-10-18_retro_transformation.md`

**When updating:**
1. Mark tasks complete in work effort doc
2. Create new devlog for each session
3. Update index files if creating new docs
4. Cross-reference related documents

### Priority Task 1: Multiple AI User Personas

The Ollama integration currently only posts from one "Ollama Bot" user. We need multiple AI personas:

**1. Create AI User Personas** (`setup.mjs`):
```javascript
// Add multiple AI users with different personas
const aiUsers = [
  {
    email: 'techie@pocketbase.dev',
    password: 'AIUser2025!',
    displayName: 'TechGuru42',
    persona: 'tech_enthusiast', // loves coding, startups, new tech
  },
  {
    email: 'philosopher@pocketbase.dev',
    password: 'AIUser2025!',
    displayName: 'DeepThoughts',
    persona: 'philosopher', // deep thoughts, existential questions
  },
  {
    email: 'comedian@pocketbase.dev',
    password: 'AIUser2025!',
    displayName: 'LOL_Master',
    persona: 'comedian', // jokes, memes, funny observations
  },
  {
    email: 'news@pocketbase.dev',
    password: 'AIUser2025!',
    displayName: 'NewsBot90s',
    persona: 'news_reporter', // reports on trends, tech news
  },
];

// Seed these users in the setup script
for (const user of aiUsers) {
  await seedRecord('users', user, `email = "${user.email}"`);
}
```

**2. Update Ollama Feed Script** (`ollama-feed.mjs`):
```javascript
// Rotate between AI personas
const AI_PERSONAS = {
  tech_enthusiast: {
    userId: 'techie_user_id',
    systemPrompt: 'You are TechGuru42, a 90s tech enthusiast excited about new technology. Write short, enthusiastic posts about coding, startups, and tech trends. Use 90s internet slang occasionally.',
    categories: ['tech', 'coding'],
  },
  philosopher: {
    userId: 'philosopher_user_id',
    systemPrompt: 'You are DeepThoughts, a contemplative person who shares deep observations about life and technology. Write thoughtful, brief posts that make people think.',
    categories: ['thoughts', 'philosophy'],
  },
  comedian: {
    userId: 'comedian_user_id',
    systemPrompt: 'You are LOL_Master, a funny person who shares jokes and humorous observations. Keep it light and entertaining with 90s humor.',
    categories: ['humor', 'fun'],
  },
  news_reporter: {
    userId: 'news_user_id',
    systemPrompt: 'You are NewsBot90s, reporting on tech trends and internet culture in the style of 90s news. Be informative but casual.',
    categories: ['news', 'trends'],
  },
};

// Pick random persona for each post
function getRandomPersona() {
  const personas = Object.keys(AI_PERSONAS);
  return personas[Math.floor(Math.random() * personas.length)];
}

async function generatePost() {
  const personaKey = getRandomPersona();
  const persona = AI_PERSONAS[personaKey];

  const response = await generateWithOllama({
    model: OLLAMA_MODEL,
    prompt: 'Write a short social media post (1-2 sentences, max 280 chars)',
    system: persona.systemPrompt,
  });

  await postUpdate({
    content: response,
    authorId: persona.userId,
    categories: persona.categories,
  });
}
```

### Priority Task 2: Lazy Loading / Infinite Scroll

Implement proper pagination and infinite scroll for the feed:

**1. Update Feed Loading Logic** (`app.js`):
```javascript
let currentPage = 1;
const POSTS_PER_PAGE = 20;
let isLoading = false;
let hasMore = true;

async function loadPosts(page = 1, append = false) {
  if (isLoading) return;
  isLoading = true;

  try {
    const result = await pb.collection('posts').getList(page, POSTS_PER_PAGE, {
      sort: '-created',
      expand: 'author,categories',
    });

    if (!append) {
      postsListEl.innerHTML = '';
      feedState.clear();
    }

    result.items.forEach((post) => {
      feedState.set(post.id, post);
      const postEl = renderFeedItem(post);
      postsListEl.append(postEl);
    });

    hasMore = result.page < result.totalPages;
    updateStats();
    appendLog(`✅ Loaded ${result.items.length} posts (page ${page}/${result.totalPages})`);
    setConnectionStatus(true);
  } catch (error) {
    appendLog(`❌ Failed to load posts: ${error?.message || error}`);
    setConnectionStatus(false);
  } finally {
    isLoading = false;
  }
}

// Infinite scroll detection
const feedContainer = document.getElementById('postsList');
feedContainer.addEventListener('scroll', () => {
  const scrolled = feedContainer.scrollTop + feedContainer.clientHeight;
  const total = feedContainer.scrollHeight;

  // Load more when user is 200px from bottom
  if (scrolled >= total - 200 && hasMore && !isLoading) {
    currentPage++;
    loadPosts(currentPage, true); // append=true
  }
});

// "Load More" button fallback
const loadMoreBtn = document.createElement('button');
loadMoreBtn.textContent = 'Load More Posts';
loadMoreBtn.className = 'secondary load-more-btn';
loadMoreBtn.addEventListener('click', () => {
  if (hasMore && !isLoading) {
    currentPage++;
    loadPosts(currentPage, true);
  }
});
// Add to feed area if needed
```

**2. Add Loading Indicator** (`index.html` + `app.js`):
```html
<div id="loadingIndicator" class="loading-indicator" style="display: none;">
  <span class="loading-spinner">⏳</span>
  <span>Loading more posts...</span>
</div>
```

```javascript
function showLoading() {
  document.getElementById('loadingIndicator').style.display = 'block';
}

function hideLoading() {
  document.getElementById('loadingIndicator').style.display = 'none';
}
```

**3. Smart Real-Time Updates** (`app.js`):
```javascript
// Track if user is viewing top of feed
let isAtTop = true;
let newPostsCount = 0;

feedContainer.addEventListener('scroll', () => {
  isAtTop = feedContainer.scrollTop < 100;
  if (isAtTop && newPostsCount > 0) {
    // User scrolled to top, clear notification
    newPostsCount = 0;
    updateNewPostsBadge();
  }
});

// On new post via realtime
await pb.collection('posts').subscribe('*', async (event) => {
  if (event.action === 'create') {
    const fullRecord = await pb.collection('posts').getOne(event.record.id, {
      expand: 'author,categories',
    });

    if (isAtTop) {
      // User is at top, insert immediately
      feedState.set(fullRecord.id, fullRecord);
      const newItem = renderFeedItem(fullRecord);
      postsListEl.prepend(newItem);
      newItem.style.animation = 'slideInFromTop 0.3s ease';
    } else {
      // User scrolled down, show badge
      newPostsCount++;
      updateNewPostsBadge();
    }

    updateStats();
  }
});

function updateNewPostsBadge() {
  const badge = document.getElementById('newPostsBadge');
  if (newPostsCount > 0) {
    badge.textContent = `${newPostsCount} new posts`;
    badge.style.display = 'block';
  } else {
    badge.style.display = 'none';
  }
}
```

**4. Add "New Posts" Badge** (`index.html`):
```html
<div id="newPostsBadge" class="new-posts-badge" style="display: none;">
  <button onclick="scrollToTop()">View new posts ↑</button>
</div>
```

### Example Next Task: Hit Counter

Here's how you might implement the hit counter (lower priority):

**1. Update HTML** (`public/index.html`):
```html
<div class="hit-counter">
  <span class="counter-label">You are visitor:</span>
  <div class="counter-display" data-hit-counter>
    <span class="digit">0</span>
    <span class="digit">0</span>
    <span class="digit">0</span>
    <span class="digit">0</span>
    <span class="digit">0</span>
    <span class="digit">0</span>
  </div>
</div>
```

**2. Add CSS** (`public/style.css`):
```css
.hit-counter {
  position: fixed;
  bottom: 20px;
  right: 20px;
  background: #000;
  border: 4px ridge #ff00ff;
  padding: 12px;
  font-family: 'Courier New', monospace;
  box-shadow: 6px 6px 0 #000;
}

.counter-display {
  display: flex;
  gap: 2px;
  margin-top: 6px;
}

.digit {
  background: #ff0000;
  color: #00ff00;
  width: 24px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 20px;
  font-weight: bold;
  border: 2px solid #000;
}
```

**3. Add JavaScript** (`public/app.js`):
```javascript
async function updateHitCounter() {
  try {
    const stats = await pb.collection('site_stats').getFirstListItem('');
    const newCount = stats.visitor_count + 1;

    await pb.collection('site_stats').update(stats.id, {
      visitor_count: newCount,
      last_visit: new Date().toISOString(),
    });

    // Animate digits
    const digits = document.querySelectorAll('.digit');
    const countStr = newCount.toString().padStart(6, '0');
    digits.forEach((digit, i) => {
      digit.textContent = countStr[i];
      digit.style.animation = 'digitFlip 0.3s ease';
    });

    appendLog(`👁️ Visitor count: ${newCount}`);
  } catch (error) {
    appendLog(`❌ Failed to update hit counter: ${error?.message}`);
  }
}

// Call on init
init().then(() => updateHitCounter());
```

### Resources
- [PocketBase Docs](https://pocketbase.io/docs/)
- [Ollama Docs](https://ollama.ai/docs/)
- [90s Web Design](https://www.cameronsworld.net/)
- [Johnny Decimal](https://johnnydecimal.com/)

### Questions to Ask User
If you need clarification:
1. "How many AI personas do you want? Should they have specific personalities or topics?"
2. "What should be the posting frequency for AI bots? (e.g., every 30s, 1min, 5min?)"
3. "Should users be able to reply to posts or just create top-level posts?"
4. "Do you want likes/reactions on posts?"
5. "Should the feed have a maximum post limit or grow indefinitely?"
6. "Do you want sound effects when new posts arrive?"

### Success Criteria
You'll know you're done when:
- Multiple AI personas are posting with different personalities
- Feed loads most recent posts first (latest at top)
- Lazy loading/infinite scroll works smoothly
- Users can scroll back through all historical posts
- Real-time updates work without disrupting user's scroll position
- New posts appear at top of feed when user is viewing top
- Loading indicators show during fetch operations
- The site maintains 90s aesthetic while being fully functional
- Posts persist across server restarts
- Code is clean and well-documented
- Work efforts documentation is updated
- DevLog is created for your session

### Final Notes
- Have fun! The 90s aesthetic should feel playful and nostalgic
- Don't break existing functionality
- Test real-time updates after changes
- Keep the AI integration working
- Update documentation as you go
- Commit frequently with good messages

## Related Documents
- [[00.01_ollama_90s_social_feed]] - Main work effort
- [[../02_devlogs/00.01_2025-10-18_retro_transformation]] - Previous session
- [[../../00_organization/00.01_johnny_decimal_system]] - Organization system

## Quick Start Prompt

```
I'm continuing work on the Ollama-powered 90s social feed project at:
/Users/ctavolazzi/Code/awesome-pocketbase

Please read:
1. work_efforts/00-09_project_management/01_work_efforts/00.01_ollama_90s_social_feed.md
2. work_efforts/00-09_project_management/01_work_efforts/00.02_continuation_prompt.md

Current Priority: Transform this into a fully functional social media app with:
- Multiple AI user personas posting different types of content
- Standard social feed features (lazy loading, infinite scroll)
- Load most recent posts first, fetch older posts as user scrolls
- Real-time updates that don't disrupt user experience
- Persistent data across restarts

Then:
1. Start the servers (PocketBase + web server + Ollama)
2. Verify the current setup is working
3. Focus on Priority Tasks in order:
   a) Multiple AI personas with different personalities
   b) Lazy loading / infinite scroll implementation
   c) Smart real-time updates (with "new posts" badge)
   d) Optimize for large post counts

Maintain the 90s retro aesthetic while making it a fully functional social media platform.
```

## End of Document
**Last Updated:** 2025-10-18 09:56

